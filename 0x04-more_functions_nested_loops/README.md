This contains more fuctions and nested loops
